<!DOCTYPE html>
<html lang="kr" layout:decorate="~{layouts/layout}">
  <div layout:fragment="content">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title fw-semibold mb-4">도서 목록</h5>
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th scope="col">#</th>
                <th scope="col">코드</th>
                <th scope="col">제목</th>
                <th scope="col">가격</th>
                <th scope="col">저자</th>
                <th scope="col">등록일</th>
                <th scope="col">관리</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="book, i : ${list}">
                <th
                  scope="row"
                  th:text="${page.totalCount - ((page.pageRequestDTO.page - 1) * page.pageRequestDTO.size + i.index)}"
                >
                  1
                </th>
                <td th:text="${book.isbn}">978-89-00-00000-0</td>
                <td>
                  <a
                    th:href="@{/book/read(id=${book.id})}"
                    th:text="${book.title}"
                    >제목입니다</a
                  >
                </td>
                <td
                  th:text="${#numbers.formatDecimal(book.price, 0, 'COMMA', 0, 'POINT')} + '원'"
                >
                  25,000원
                </td>
                <td th:text="${book.author}">홍길동</td>
                <td
                  th:text="${#temporals.format(book.createDateTime, 'yyyy-MM-dd HH:mm')}"
                >
                  2023-10-26 10:00
                </td>
                <td>
                  <a
                    th:href="@{/book/modify(id=${book.id}, fromPage='list')}"
                    class="btn btn-sm btn-primary"
                    >수정</a
                  >           
                  <form
                    th:action="@{/book/remove}"
                    method="post"
                    style="display: inline"
                    th:data-booktitle="${book.title}"
                    onsubmit="return confirm('정말로 도서 ' + this.getAttribute('data-booktitle') + '을(를) 삭제하시겠습니까?');"
                  >
                    <input type="hidden" name="id" th:value="${book.id}" />
                    <button type="submit" class="btn btn-sm btn-danger">
                      삭제
                    </button>
                  </form>
                </td>
              </tr>
              <tr th:if="${#lists.isEmpty(list)}">
                <td colspan="8" class="text-center">등록된 도서가 없습니다.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div
          th:replace="~{fragments/pagination :: paginationFragment(${page})}"
        ></div>
        <div class="mt-3 text-end">
          <a th:href="@{/book/register}" class="btn btn-success">
                        <i class="ti ti-plus me-1"></i> 새 도서 등록          
          </a>
        </div>
      </div>
    </div>
  </div>
  <th:block layout:fragment="script">
       
    <script th:inline="javascript">
      const resultMessage = /*[[${msg}]]*/ "default";
      if (resultMessage) {
        Swal.fire({
          title: resultMessage,
          icon: "success",
        });
      }
    </script>
     
  </th:block>
</html>
