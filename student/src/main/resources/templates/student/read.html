<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/main_layout}"
>
  <th:block layout:fragment="css">
    <style>
      .card-text {
        white-space: pre-wrap;
      }
    </style>
  </th:block>
  <th:block layout:fragment="title">
    <title>í•™ìƒ ì •ë³´</title>
  </th:block>
  <div layout:fragment="content">
    <div class="container mt-5">
      <h1 class="mb-4">í•™ìƒ ì •ë³´ ì¡°íšŒ</h1>

      <div class="card shadow-sm">
        <div class="card-body">
          <h6 class="card-subtitle mb-2 text-muted">
            í•™ë²ˆ: <span th:text="${dto.id}">1</span> | ë“±ë¡ì¼:
            <span
              th:text="${#temporals.format(dto.createDateTime, 'yyyy-MM-dd HH:mm')}"
              >2025-01-01</span
            >
          </h6>
          <hr />

          <table class="table table-bordered">
            <tbody>
              <tr>
                <th style="width: 150px">ì´ë¦„</th>
                <td th:text="${dto.name}">í™ê¸¸ë™</td>
              </tr>
              <tr>
                <th>ì£¼ì†Œ</th>
                <td th:text="${dto.addr}">ì„œìš¸ì‹œ ê°•ë‚¨êµ¬</td>
              </tr>
              <tr>
                <th>í•™ë…„</th>
                <td th:text="${dto.grade}">SENIOR</td>
              </tr>
              <tr>
                <th>ì„±ë³„</th>
                <td th:text="${dto.gender == 'M' ? 'ë‚¨ì„±' : 'ì—¬ì„±'}">M</td>
              </tr>

              <tr>
                <th>ìˆ˜ì •ì¼</th>
                <td>
                  <small
                    class="text-secondary"
                    th:if="${dto.updateDateTime != null}"
                  >
                    <span
                      th:text="${#temporals.format(dto.updateDateTime, 'yyyy-MM-dd HH:mm')}"
                    ></span>
                  </small>
                  <span th:unless="${dto.updateDateTime != null}">-</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="mt-4 text-center">
        <a th:href="@{/student/list}" class="btn btn-secondary me-2"
          >ëª©ë¡ìœ¼ë¡œ</a
        >

        <a
          th:href="@{/student/modify(id=${dto.id})}"
          class="btn btn-warning me-2"
        >
          ìˆ˜ì • (Modify)
        </a>

        <button type="button" class="btn btn-danger" id="removeBtn">
          ì‚­ì œ (Remove)
        </button>

        <form th:action="@{/student/remove}" method="post" id="removeForm">
          <input type="hidden" name="id" th:value="${dto.id}" />
        </form>
      </div>
    </div>
  </div>

  <th:block layout:fragment="script">
    <script>
      // ğŸŒŸ ì‚­ì œ í™•ì¸ íŒì—… ë° í¼ ì œì¶œ ë¡œì§ ğŸŒŸ
      document
        .getElementById("removeBtn")
        .addEventListener("click", function () {
          const confirmed = confirm(
            "ì •ë§ë¡œ ì´ í•™ìƒ ì •ë³´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‚­ì œëœ ë°ì´í„°ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
          );
          if (confirmed) {
            // ì·¨ì†Œ ë²„íŠ¼ì˜ hrefë¥¼ ì´ìš©í•˜ì—¬ ëª©ë¡ í˜ì´ì§€ URLì„ ì•Œë¦´ ìˆ˜ë„ ìˆì§€ë§Œ,
            // ì—¬ê¸°ì„œëŠ” ê¹”ë”í•˜ê²Œ í¼ ì œì¶œë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.
            document.getElementById("removeForm").submit();
          } else {
            alert("ì‚­ì œë¥¼ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤.");
          }
        });
    </script>
    <script th:inline="javascript">
      const resultMessage = /*[[${msg}]]*/ "default";
      if (resultMessage) {
        Swal.fire({
          title: resultMessage,
          icon: "success",
        });
      }
    </script>
  </th:block>
</html>
